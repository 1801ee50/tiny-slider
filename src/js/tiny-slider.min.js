/**
  * tiny-slider
  * @version 0.3.1
  * @author William Lin
  * @license The MIT License (MIT)
  * @github https://github.com/ganlanyuan/tiny-slider/
  * 
  * DEPENDENCIES:
  * firstElementChild, lastElementChild
  * addEventListener
  * extend
  * wrap
  * append
  * 
  */
!function(t){window.tinySlider=t()}(function(){"use strict";function t(t){return t*(180/Math.PI)}function e(t,e){return Math.abs(90-Math.abs(t))>=90-e?"horizontal":Math.abs(90-Math.abs(t))<=e?"vertical":!1}function n(t){return t&&"object"==typeof t?Object.keys(t):!1}function i(t,e){if(t&&"object"==typeof t){for(var n=[],i=0;i<e.length;i++){var a=e[i];n.push(t[a])}return n}return!1}function a(t,e,n){var i=document.documentElement.clientWidth;if(void 0===t.length||void 0===e||t.length!==e.length)return n;if(i<t[0])return n;if(i>=t[t.length-1])return e[e.length-1];for(var a=0;a<t.length-1;a++)if(i>=t[a]&&i<=t[a+1])return e[a]}function o(t){var e=document.querySelectorAll(t.container);if(0!==e.length)for(var n=e.length;n--;){var i=t;i.container=e[n];var a=new s(i)}}function s(o){o=gn.extend({container:".slider",items:1,fixedWidth:!1,maxContainerWidth:!1,slideByPage:!1,nav:!0,navText:["prev","next"],navContainer:!1,dots:!0,dotContainer:!1,arrowKeys:!1,speed:250,autoplay:!1,autoplayTimeout:5e3,autoplayDirection:"forward",loop:!0,responsive:!1,lazyload:!1,offset:0,touch:!0},o||{});var s=this,d=o.container,c=d.children,h=c.length,u=c.length,f=o.fixedWidth,v=o.nav,m=o.navText,p=o.navContainer,y=o.dots,g=o.dotContainer,L=o.arrowKeys,M=r?o.speed:0,b=o.autoplay,C=o.autoplayTimeout,x="forward"===o.autoplayDirection?1:-1,w=o.loop,D=o.slideByPage,k=f?!1:o.responsive,T=o.lazyload,E=o.touch,N=n(k),I=i(k,N),P=void 0!==I.length?Math.max.apply(Math,I):o.items,S=f?Math.floor(d.parentNode.offsetWidth/f):a(N,I,o.items);f&&o.maxContainerWidth?P=Math.ceil(o.maxContainerWidth/f):f&&(w=!1),P=Math.min(h,P),S=Math.min(h,S);var A,W,z=g?h:Math.ceil(h/S),V,B=!1,q=0,O,X;if(T){var j=o.offset,F={},K={},R=!1;F.top=0-j,F.left=0-j}if(E)var Y=0,H=0,G=0,J=0,Q=0,U=0,Z=!1,_=!1,B=!1,tt=!1;this.getAbsIndex=function(){return 0>q?q+h:q>=h?q-h:q},this.setTransitionDuration=function(t){r&&(d.style[r]=M*t/1e3+"s",B=!0)},this.setDotCurrent=function(){if(V=g?this.getAbsIndex():Math.floor(this.getAbsIndex()/S),!w&&!g){var t=/^-?[0-9]+$/,e=t.test(h/S);e||q!==h-S||(V+=1)}},this.init=function(){d.classList.add("tiny-content");var t=document.createElement("div");if(t.className="tiny-slider",gn.wrap(d,t),navigator.msMaxTouchPoints&&(t.classList.add("ms-touch"),t.addEventListener("scroll",function(){r&&(d.style[r]="0s"),d.style.transform="translate3d(-"+-d.scrollLeft()+"px,0,0)"})),y)if(g)W=g.children,W[0].classList.add("tiny-active");else{for(var e="",n=h;n--;)e+='<div class="tiny-dot"></div>';e='<div class="tiny-dots">'+e+"</div>",gn.append(t,e),W=t.querySelectorAll(".tiny-dot")}if(v&&(p?(O=p.firstElementChild,X=p.lastElementChild):(gn.append(t,'<div class="tiny-nav"><div class="tiny-prev">'+m[0]+'</div><div class="tiny-next">'+m[1]+"</div></div>"),O=t.querySelector(".tiny-prev"),X=t.querySelector(".tiny-next"))),w){for(var i=document.createDocumentFragment(),a=document.createDocumentFragment(),o=P;o--;){var l=c[o].cloneNode(!0),f=c[c.length-1-o].cloneNode(!0);i.insertBefore(l,i.firstChild),a.insertBefore(f,a.firstChild)}d.appendChild(i),d.insertBefore(a,d.firstChild),u=d.children.length,c=d.children}if(this.setDotCurrent(),this.makeLayout(),this.setSnapInterval(),this.translate(),this.itemActive(),v&&(this.disableNav(),X.addEventListener("click",function(){s.onNavClick(1)}),O.addEventListener("click",function(){s.onNavClick(-1)})),y){g||(this.displayDots(),this.dotActive());for(var M=0;M<W.length;M++)W[M].addEventListener("click",this.fireDotClick())}T&&(this.saveViewport(),this.sliderInView(),this.lazyLoad()),L&&document.addEventListener("keydown",function(t){t=t||window.event,37===t.keyCode?s.onNavClick(-1):39===t.keyCode&&s.onNavClick(1)}),b&&setInterval(function(){s.onNavClick(x)},C),E&&!tt&&d.addEventListener&&(d.addEventListener("touchstart",s.onPanStart(),!1),d.addEventListener("touchmove",s.onPanMove(),!1),d.addEventListener("touchend",s.onPanEnd(),!1),d.addEventListener("touchcancel",s.onPanEnd(),!1),tt=!0)},this.makeLayout=function(){A=f?f:d.parentNode.offsetWidth/S,d.style.width=A*u+"px";for(var t=0;u>t;t++)c[t].style.width=A+"px";if(w){var e=-(P*A);d.style.marginLeft=e+"px"}},this.setSnapInterval=function(){navigator.msMaxTouchPoints&&(d.parentNode.style.msScrollSnapPointsX="snapInterval(0%, "+A+")")},this.itemActive=function(){for(var t=w?q+P:q,e=0;u>e;e++)e===t?c[e].classList.add("tiny-current","tiny-visible"):e>t&&t+S>e?(c[e].classList.remove("tiny-current"),c[e].classList.add("tiny-visible")):c[e].classList.remove("tiny-current","tiny-visible")},this.disableNav=function(){w||(0===q?O.classList.add("disabled"):O.classList.remove("disabled"),q===h-S?X.classList.add("disabled"):X.classList.remove("disabled"))},this.displayDots=function(){for(var t=0;t<W.length;t++)z>t?W[t].classList.remove("tiny-hide"):W[t].classList.add("tiny-hide")},this.dotActive=function(){if(y)for(var t=0;z>t;t++)t===V?W[t].classList.add("tiny-active"):W[t].classList.remove("tiny-active")},this.translate=function(){var t=d.parentNode.offsetWidth;G=-A*q,f&&!w&&(G=Math.max(G,-(u*A-t))),l?d.style[l]="translate3d("+G+"px, 0, 0)":d.style.left=G+"px"},this.fallback=function(){if(w){var t=D?-(P-S)>q:-P>=q,e=D?q>h+P-2*S-1:q>=h+P-S;f&&P&&!D&&(e=q>=h+P-S-1),t&&(q+=h),e&&(q-=h),r&&(d.style[r]="0s"),this.translate()}},this.update=function(){this.fallback(),this.itemActive(),this.disableNav(),this.dotActive(),this.lazyLoad(),B=!1},this.onNavClick=function(t){if(!B){var e,n;t=D?t*S:t,n=Math.abs(t),e=q+t,q=w?e:Math.max(0,Math.min(e,h-S)),this.setTransitionDuration(n),this.translate(),this.setDotCurrent(),setTimeout(function(){s.update()},M*n)}},this.fireDotClick=function(){return function(){for(var t,e=0;e<W.length;e++)W[e]===this&&(t=e);s.onDotClick(t)}},this.onDotClick=function(t){if(!B){var e,n;e=g?t:t*S,e=w?e:Math.min(e,h-S),n=Math.abs(e-q),q=e,this.setTransitionDuration(n),this.translate(),V=t,setTimeout(function(){s.update()},M*n)}},this.saveViewport=function(){F.bottom=document.documentElement.clientHeight+j,F.right=document.documentElement.clientWidth+j},this.sliderInView=function(){var t=d.parentNode.getBoundingClientRect();K.left=t.left,K.right=t.right,K.top=t.top,K.bottom=t.bottom,R=t.right>F.left&&t.bottom>F.top&&t.left<F.right&&t.top<F.bottom},this.elementInView=function(t,e){var n=t.getBoundingClientRect();return n.right>e.left&&n.bottom>e.top&&n.left<e.right&&n.top<e.bottom},this.lazyLoad=function(){if(R){var t=d.querySelectorAll(".tiny-lazy");if(t)for(var e=0;e<t.length;e++)this.elementInView(t[e],K)&&-1===t[e].className.indexOf("loaded")&&(t[e].src=t[e].getAttribute("data-src"),t[e].className+=" loaded")}},this.onPanStart=function(){return function(t){var e=t.changedTouches[0];Y=parseInt(e.clientX),H=parseInt(e.clientY)}},this.onPanMove=function(){return function(n){var i=n.changedTouches[0];if(J=parseInt(i.clientX)-Y,Q=parseInt(i.clientY)-H,U=t(Math.atan2(Q,J)),Z=e(U,15),"horizontal"===Z&&B===!1&&(_=!0),_){r&&(d.style[r]="0s");var a=w?-(h+P-S)*A:-(h-S)*A,o=w?P*A:0;!w&&f&&(a=-(h*A-d.parentNode.offsetWidth)),G=-q*A+J,G=Math.max(a,Math.min(G,o)),l?d.style[l]="translate3d("+G+"px, 0, 0)":d.style.left=G+"px",n.preventDefault()}}},this.onPanEnd=function(){return function(t){var e=t.changedTouches[0];if(J=parseInt(e.clientX)-Y,_&&0!==J){t.preventDefault(),_=!1,G=-q*A+J;var n,i=w?-P:0,a=w?h+P-S:h-S;n=-(G/A),n=0>J?Math.ceil(n):Math.floor(n),n=Math.max(i,Math.min(n,a)),q=n,s.setTransitionDuration(1),s.translate(),s.setDotCurrent(),setTimeout(function(){s.update()},M)}}},this.init();var et;window.addEventListener("resize",function(){clearTimeout(et),et=setTimeout(function(){S=f?Math.floor(d.parentNode.offsetWidth/f):a(N,I,o.items),S=Math.min(h,S),z=g?h:Math.ceil(h/S),M=D?o.speed*S:o.speed,s.setDotCurrent(),s.makeLayout(),s.setSnapInterval(),s.translate(),y&&!g&&(s.displayDots(),s.dotActive()),T&&(s.saveViewport(),s.sliderInView(),s.lazyLoad())},100)}),window.addEventListener("scroll",function(){T&&(s.saveViewport(),s.sliderInView(),s.lazyLoad())})}var r=gn.getSupportedProp(["transitionDuration","WebkitTransitionDuration","MozTransitionDuration","OTransitionDuration"]),l=gn.getSupportedProp(["transform","WebkitTransform","MozTransform","OTransform"]);return o});