/**
  * tiny-slider
  * @version 0.3.1
  * @author William Lin
  * @license The MIT License (MIT)
  * @github https://github.com/ganlanyuan/tiny-slider/
  * 
  * DEPENDENCIES:
  * firstElementChild, lastElementChild
  * addEventListener
  * extend
  * wrap
  * append
  * indexOf
  * 
  */
!function(t){window.tinySlider=t()}(function(){"use strict";function t(t){return t*(180/Math.PI)}function n(t,n){return Math.abs(90-Math.abs(t))>=90-n?"horizontal":Math.abs(90-Math.abs(t))<=n?"vertical":!1}function e(t){return t&&"object"==typeof t?Object.keys(t):!1}function i(t,n){if(t&&"object"==typeof t){for(var e=[],i=0;i<n.length;i++){var a=n[i];e.push(t[a])}return e}return!1}function a(t){t=gn.extend({container:".slider",items:1,fixedWidth:!1,maxContainerWidth:!1,slideByPage:!1,nav:!0,navText:["prev","next"],navContainer:!1,dots:!0,dotsContainer:!1,arrowKeys:!1,speed:250,autoplay:!1,autoplayTimeout:5e3,autoplayDirection:"forward",loop:!0,responsive:!1,lazyload:!1,touch:!0},t||{});var n=document.querySelectorAll(t.container);if(0!==n.length)for(var e=n.length;e--;){var i=t;return i.container=n[e],new s(i)}}function s(a){var s=this,l=a.container,c=l.children,d=c.length,u=c.length,h=a.fixedWidth,v=a.nav,f=a.navText,y=a.navContainer?document.querySelector(a.navContainer):!1,p=a.dots,m=a.dotsContainer?document.querySelector(a.dotsContainer):!1,L=a.arrowKeys,g=o?a.speed:0,M=a.autoplay,x=a.autoplayTimeout,C="forward"===a.autoplayDirection?1:-1,b=h&&!a.maxContainerWidth?!1:a.loop,T=a.slideByPage,k=a.lazyload,D=a.touch,E,w,N,S,P,z,W,I,A=0,q=!1,B=-1;if(D)var O=0,X=0,j=0,F=0,K=0,Y=!1,V=!1;var G=h?!1:a.responsive,H=e(G),J=i(G,H),Q=function(){return h?function(){return Math.min(d,Math.floor(l.parentNode.offsetWidth/h))}:function(){var t,n=document.documentElement.clientWidth;if(void 0!==H.length&&void 0!==J&&H.length===J.length)if(n<H[0])t=a.items;else if(n>=H[H.length-1])t=J[J.length-1];else for(var e=0;e<H.length-1;e++)n>=H[e]&&n<=H[e+1]&&(t=J[e]);else t=a.items;return Math.min(d,t)}}(),R=function(){var t;return t=h?a.maxContainerWidth?Math.ceil(a.maxContainerWidth/h):!1:void 0!==J.length?Math.max.apply(Math,J):a.items,t?Math.min(d,t):t},U=function(){return h?function(){return h}:function(){return l.parentNode.offsetWidth/N}}(),Z=function(){return m?function(){return d}:function(){return Math.ceil(d/N)}}();N=Q(),w=R(),E=U(),I=Z(),this.updateLayout=function(){l.style.width=E*u+"px",b&&(l.style.marginLeft=-(w*E)+"px");for(var t=u;t--;)c[t].style.width=E+"px"},this.setTransitionDuration=function(t){o&&(l.style[o]=g*t/1e3+"s",q=!0)},this.setSnapInterval=function(){navigator.msMaxTouchPoints&&(l.parentNode.style.msScrollSnapPointsX="snapInterval(0%, "+E+")")},this.slideActive=function(){for(var t=b?A+w:A,n=u;n--;)t>n||n>=t+N?c[n].classList.contains("tiny-visible")&&c[n].classList.remove("tiny-current","tiny-visible"):n===t?c[n].classList.add("tiny-current","tiny-visible"):c[n].classList.contains("tiny-visible")||(c[n].classList.remove("tiny-current"),c[n].classList.add("tiny-visible"))},this.disableNav=function(){b||(0===A?S.classList.add("disabled"):S.classList.remove("disabled"),A===d-N?P.classList.add("disabled"):P.classList.remove("disabled"))},this.displayDots=function(){if(p&&!m)for(var t=W;t--;){var n=z[t];I>t?n.classList.contains("tiny-hide")&&n.classList.remove("tiny-hide"):n.classList.contains("tiny-hide")||n.classList.add("tiny-hide")}},this.dotActive=function(){if(p){var t;if(-1===B){var n=0>A?A+d:A>=d?A-d:A;if(t=m?n:Math.floor(n/N),!b&&!m){var e=/^-?[0-9]+$/,i=e.test(d/N);i||A!==d-N||(t+=1)}}else t=B,B=-1;for(var a=I;a--;){var s=z[a];a===t?s.classList.contains("tiny-active")||s.classList.add("tiny-active"):s.classList.contains("tiny-active")&&s.classList.remove("tiny-active")}}},this.translate=function(){var t=l.parentNode.offsetWidth;j=-E*A,h&&!b&&(j=Math.max(j,-(u*E-t))),r?l.style[r]="translate3d("+j+"px, 0, 0)":l.style.left=j+"px"},this.fallback=function(){if(b){var t=T?N-w>A:-w>=A,n=T?A>d+w-2*N-1:A>=d+w-N;h&&w&&!T&&(n=A>=d+w-N-1),t&&(A+=d),n&&(A-=d),o&&(l.style[o]="0s"),this.translate()}},this.update=function(){this.fallback(),this.slideActive(),this.disableNav(),this.dotActive(),this.lazyLoad(),q=!1},this.onNavClick=function(t){if(!q){var n,e;t=T?t*N:t,e=Math.abs(t),n=A+t,A=b?n:Math.max(0,Math.min(n,d-N)),this.setTransitionDuration(e),this.translate(),setTimeout(function(){s.update()},g*e)}},this.fireDotClick=function(){return function(){var t=gn.indexOf(z,this);s.onDotClick(t)}},this.onDotClick=function(t){if(!q){B=t;var n,e;n=m?t:t*N,n=b?n:Math.min(n,d-N),e=Math.abs(n-A),A=n,this.setTransitionDuration(e),this.translate(),setTimeout(function(){s.update()},g*e)}},this.lazyLoad=function(){if(gn.isInViewport(l)){var t=l.querySelectorAll(".tiny-visible .tiny-lazy");if(0!==t.length)for(var n=0,e=t.length;e>n;n++)t[n].classList.contains("loaded")||(t[n].src=t[n].getAttribute("data-src"),t[n].classList.add("loaded"))}},this.onPanStart=function(){return function(t){var n=t.changedTouches[0];O=parseInt(n.clientX),X=parseInt(n.clientY)}},this.onPanMove=function(){return function(e){var i=e.changedTouches[0];F=parseInt(i.clientX)-O,K=parseInt(i.clientY)-X;var a=t(Math.atan2(K,F)),s=n(a,15);if("horizontal"===s&&q===!1&&(Y=!0),Y){o&&(l.style[o]="0s");var c=b?-(d+w-N)*E:-(d-N)*E,u=b?w*E:0;!b&&h&&(c=-(d*E-l.parentNode.offsetWidth)),j=-A*E+F,j=Math.max(c,Math.min(j,u)),r?l.style[r]="translate3d("+j+"px, 0, 0)":l.style.left=j+"px",e.preventDefault()}}},this.onPanEnd=function(){return function(t){var n=t.changedTouches[0];if(F=parseInt(n.clientX)-O,Y&&0!==F){t.preventDefault(),Y=!1,j=-A*E+F;var e,i=b?-w:0,a=b?d+w-N:d-N;e=-(j/E),e=0>F?Math.ceil(e):Math.floor(e),e=Math.max(i,Math.min(e,a)),A=e,s.setTransitionDuration(1),s.translate(),setTimeout(function(){s.update()},g)}}},this.init=function(){l.classList.add("tiny-content");var t=document.createElement("div");if(t.className="tiny-slider",gn.wrap(l,t),navigator.msMaxTouchPoints&&(t.classList.add("ms-touch"),t.addEventListener("scroll",function(){o&&(l.style[o]="0s"),l.style.transform="translate3d(-"+-l.scrollLeft()+"px,0,0)"})),p){if(m)z=m.children,z[0].classList.add("tiny-active");else{for(var n="",e=d;e--;)n+='<div class="tiny-dot"></div>';n='<div class="tiny-dots">'+n+"</div>",gn.append(t,n),z=t.querySelectorAll(".tiny-dot")}W=z.length}if(v&&(y?(S=y.firstElementChild,P=y.lastElementChild):(gn.append(t,'<div class="tiny-nav"><div class="tiny-prev">'+f[0]+'</div><div class="tiny-next">'+f[1]+"</div></div>"),S=t.querySelector(".tiny-prev"),P=t.querySelector(".tiny-next"))),b){for(var i=document.createDocumentFragment(),a=document.createDocumentFragment(),r=w;r--;){var h=c[r].cloneNode(!0),g=c[d-1-r].cloneNode(!0);i.insertBefore(h,i.firstChild),a.appendChild(g)}l.appendChild(i),l.insertBefore(a,l.firstChild),u=l.children.length,c=l.children}if(this.updateLayout(),this.setSnapInterval(),this.translate(),this.slideActive(),v&&(this.disableNav(),P.addEventListener("click",function(){s.onNavClick(1)}),S.addEventListener("click",function(){s.onNavClick(-1)})),this.displayDots(),this.dotActive(),p)for(var T=0;W>T;T++)z[T].addEventListener("click",this.fireDotClick());k&&this.lazyLoad(),L&&document.addEventListener("keydown",function(t){t=t||window.event,37===t.keyCode?s.onNavClick(-1):39===t.keyCode&&s.onNavClick(1)}),M&&setInterval(function(){s.onNavClick(C)},x),D&&!V&&l.addEventListener&&(l.addEventListener("touchstart",s.onPanStart(),!1),l.addEventListener("touchmove",s.onPanMove(),!1),l.addEventListener("touchend",s.onPanEnd(),!1),l.addEventListener("touchcancel",s.onPanEnd(),!1),V=!0)},this.init();var _;window.addEventListener("resize",function(){clearTimeout(_),_=setTimeout(function(){N=Q(),E=U(),I=Z(),s.updateLayout(),s.setSnapInterval(),s.translate(),s.displayDots(),s.dotActive(),k&&s.lazyLoad()},100)}),window.addEventListener("scroll",function(){k&&s.lazyLoad()})}var o=gn.getSupportedProp(["transitionDuration","WebkitTransitionDuration","MozTransitionDuration","OTransitionDuration"]),r=gn.getSupportedProp(["transform","WebkitTransform","MozTransform","OTransform"]);return a});