/**
  * tiny-slider
  * @version 0.3.1
  * @author William Lin
  * @license The MIT License (MIT)
  * @github https://github.com/ganlanyuan/tiny-slider/
  * 
  * DEPENDENCIES:
  * firstElementChild, lastElementChild
  * addEventListener
  * extend
  * wrap
  * append
  * 
  */
!function(t){window.tinySlider=t()}(function(){"use strict";function t(t){return t*(180/Math.PI)}function e(t,e){return Math.abs(90-Math.abs(t))>=90-e?"horizontal":Math.abs(90-Math.abs(t))<=e?"vertical":!1}function n(t){return t&&"object"==typeof t?Object.keys(t):!1}function i(t,e){if(t&&"object"==typeof t){for(var n=[],i=0;i<e.length;i++){var a=e[i];n.push(t[a])}return n}return!1}function a(t){var e=document.querySelectorAll(t.container);if(0!==e.length)for(var n=e.length;n--;){var i=t;i.container=e[n];var a=new s(i)}}function s(a){a=gn.extend({container:".slider",items:1,fixedWidth:!1,maxContainerWidth:!1,slideByPage:!1,nav:!0,navText:["prev","next"],navContainer:!1,dots:!0,dotContainer:!1,arrowKeys:!1,speed:250,autoplay:!1,autoplayTimeout:5e3,autoplayDirection:"forward",loop:!0,responsive:!1,lazyload:!1,touch:!0},a||{});var s=this,l=a.container,d=l.children,c=d.length,h=d.length,u=a.fixedWidth,v=a.nav,f=a.navText,y=a.navContainer,m=a.dots,p=a.dotContainer,g=a.arrowKeys,L=o?a.speed:0,M=a.autoplay,x=a.autoplayTimeout,C="forward"===a.autoplayDirection?1:-1,b=u&&!a.maxContainerWidth?!1:a.loop,D=a.slideByPage,k=u?!1:a.responsive,T=a.lazyload,I=a.touch,E=n(k),w=i(k,E);this.getItems=function(){var t;if(u)t=Math.floor(l.parentNode.offsetWidth/u);else{var e=document.documentElement.clientWidth;if(void 0!==E.length&&void 0!==w&&E.length===w.length)if(e<E[0])t=a.items;else if(e>=E[E.length-1])t=w[w.length-1];else for(var n=0;n<E.length-1;n++)e>=E[n]&&e<=E[n+1]&&(t=w[n]);else t=a.items}return Math.min(c,t)},this.getItemsMax=function(){var t;return t=u?a.maxContainerWidth?Math.ceil(a.maxContainerWidth/u):!1:void 0!==w.length?Math.max.apply(Math,w):a.items,t?Math.min(c,t):t};var N,P,S,A,z=this.getItemsMax(),W=this.getItems(),q=p?c:Math.ceil(c/W),B,X=0,j=!1,O;if(I)var F=0,K=0,Y=0,V=0,G=0,H=0,J=!1,Q=!1,j=!1,R=!1;this.init=function(){l.classList.add("tiny-content");var t=document.createElement("div");if(t.className="tiny-slider",gn.wrap(l,t),navigator.msMaxTouchPoints&&(t.classList.add("ms-touch"),t.addEventListener("scroll",function(){o&&(l.style[o]="0s"),l.style.transform="translate3d(-"+-l.scrollLeft()+"px,0,0)"})),m)if(p)N=p.children,N[0].classList.add("tiny-active");else{for(var e="",n=c;n--;)e+='<div class="tiny-dot"></div>';e='<div class="tiny-dots">'+e+"</div>",gn.append(t,e),N=t.querySelectorAll(".tiny-dot")}if(v&&(y?(P=y.firstElementChild,S=y.lastElementChild):(gn.append(t,'<div class="tiny-nav"><div class="tiny-prev">'+f[0]+'</div><div class="tiny-next">'+f[1]+"</div></div>"),P=t.querySelector(".tiny-prev"),S=t.querySelector(".tiny-next"))),b){for(var i=document.createDocumentFragment(),a=document.createDocumentFragment(),r=z;r--;){var u=d[r].cloneNode(!0),L=d[c-1-r].cloneNode(!0);i.insertBefore(u,i.firstChild),a.appendChild(L)}l.appendChild(i),l.insertBefore(a,l.firstChild),h=l.children.length,d=l.children}if(this.setDotCurrent(),this.makeLayout(),this.setSnapInterval(),this.translate(),this.itemActive(),v&&(this.disableNav(),S.addEventListener("click",function(){s.onNavClick(1)}),P.addEventListener("click",function(){s.onNavClick(-1)})),m){p||(this.displayDots(),this.dotActive());for(var D=0;D<N.length;D++)N[D].addEventListener("click",this.fireDotClick())}T&&this.lazyLoad(),g&&document.addEventListener("keydown",function(t){t=t||window.event,37===t.keyCode?s.onNavClick(-1):39===t.keyCode&&s.onNavClick(1)}),M&&setInterval(function(){s.onNavClick(C)},x),I&&!R&&l.addEventListener&&(l.addEventListener("touchstart",s.onPanStart(),!1),l.addEventListener("touchmove",s.onPanMove(),!1),l.addEventListener("touchend",s.onPanEnd(),!1),l.addEventListener("touchcancel",s.onPanEnd(),!1),R=!0)},this.getAbsIndex=function(){return 0>X?X+c:X>=c?X-c:X},this.setTransitionDuration=function(t){o&&(l.style[o]=L*t/1e3+"s",j=!0)},this.setDotCurrent=function(){if(B=p?this.getAbsIndex():Math.floor(this.getAbsIndex()/W),!b&&!p){var t=/^-?[0-9]+$/,e=t.test(c/W);e||X!==c-W||(B+=1)}},this.makeLayout=function(){A=u?u:l.parentNode.offsetWidth/W,l.style.width=A*h+"px";for(var t=0;h>t;t++)d[t].style.width=A+"px";if(b){var e=-(z*A);l.style.marginLeft=e+"px"}},this.setSnapInterval=function(){navigator.msMaxTouchPoints&&(l.parentNode.style.msScrollSnapPointsX="snapInterval(0%, "+A+")")},this.itemActive=function(){O=b?X+z:X;for(var t=h;t--;)O>t||t>=O+W?d[t].classList.contains("tiny-visible")&&d[t].classList.remove("tiny-current","tiny-visible"):t===O?d[t].classList.add("tiny-current","tiny-visible"):d[t].classList.contains("tiny-visible")||(d[t].classList.remove("tiny-current"),d[t].classList.add("tiny-visible"))},this.disableNav=function(){b||(0===X?P.classList.add("disabled"):P.classList.remove("disabled"),X===c-W?S.classList.add("disabled"):S.classList.remove("disabled"))},this.displayDots=function(){for(var t=0;t<N.length;t++)q>t?N[t].classList.remove("tiny-hide"):N[t].classList.add("tiny-hide")},this.dotActive=function(){if(m)for(var t=0;q>t;t++)t===B?N[t].classList.add("tiny-active"):N[t].classList.remove("tiny-active")},this.translate=function(){var t=l.parentNode.offsetWidth;Y=-A*X,u&&!b&&(Y=Math.max(Y,-(h*A-t))),r?l.style[r]="translate3d("+Y+"px, 0, 0)":l.style.left=Y+"px"},this.fallback=function(){if(b){var t=D?-(z-W)>X:-z>=X,e=D?X>c+z-2*W-1:X>=c+z-W;u&&z&&!D&&(e=X>=c+z-W-1),t&&(X+=c),e&&(X-=c),o&&(l.style[o]="0s"),this.translate()}},this.update=function(){this.fallback(),this.itemActive(),this.disableNav(),this.dotActive(),this.lazyLoad(),j=!1},this.onNavClick=function(t){if(!j){var e,n;t=D?t*W:t,n=Math.abs(t),e=X+t,X=b?e:Math.max(0,Math.min(e,c-W)),this.setTransitionDuration(n),this.translate(),this.setDotCurrent(),setTimeout(function(){s.update()},L*n)}},this.fireDotClick=function(){return function(){for(var t,e=0;e<N.length;e++)N[e]===this&&(t=e);s.onDotClick(t)}},this.onDotClick=function(t){if(!j){var e,n;e=p?t:t*W,e=b?e:Math.min(e,c-W),n=Math.abs(e-X),X=e,this.setTransitionDuration(n),this.translate(),B=t,setTimeout(function(){s.update()},L*n)}},this.lazyLoad=function(){if(gn.isInViewport(l)){var t=l.querySelectorAll(".tiny-visible .tiny-lazy");if(0!==!t.length)for(var e=0,n=t.length;n>e;e++)t[e].classList.contains("loaded")||(t[e].src=t[e].getAttribute("data-src"),t[e].classList.add("loaded"))}},this.onPanStart=function(){return function(t){var e=t.changedTouches[0];F=parseInt(e.clientX),K=parseInt(e.clientY)}},this.onPanMove=function(){return function(n){var i=n.changedTouches[0];if(V=parseInt(i.clientX)-F,G=parseInt(i.clientY)-K,H=t(Math.atan2(G,V)),J=e(H,15),"horizontal"===J&&j===!1&&(Q=!0),Q){o&&(l.style[o]="0s");var a=b?-(c+z-W)*A:-(c-W)*A,s=b?z*A:0;!b&&u&&(a=-(c*A-l.parentNode.offsetWidth)),Y=-X*A+V,Y=Math.max(a,Math.min(Y,s)),r?l.style[r]="translate3d("+Y+"px, 0, 0)":l.style.left=Y+"px",n.preventDefault()}}},this.onPanEnd=function(){return function(t){var e=t.changedTouches[0];if(V=parseInt(e.clientX)-F,Q&&0!==V){t.preventDefault(),Q=!1,Y=-X*A+V;var n,i=b?-z:0,a=b?c+z-W:c-W;n=-(Y/A),n=0>V?Math.ceil(n):Math.floor(n),n=Math.max(i,Math.min(n,a)),X=n,s.setTransitionDuration(1),s.translate(),s.setDotCurrent(),setTimeout(function(){s.update()},L)}}},this.init();var U;window.addEventListener("resize",function(){clearTimeout(U),U=setTimeout(function(){W=s.getItems(),q=p?c:Math.ceil(c/W),L=D?a.speed*W:a.speed,s.setDotCurrent(),s.makeLayout(),s.setSnapInterval(),s.translate(),m&&!p&&(s.displayDots(),s.dotActive()),T&&s.lazyLoad()},100)}),window.addEventListener("scroll",function(){T&&s.lazyLoad()})}var o=gn.getSupportedProp(["transitionDuration","WebkitTransitionDuration","MozTransitionDuration","OTransitionDuration"]),r=gn.getSupportedProp(["transform","WebkitTransform","MozTransform","OTransform"]);return a});