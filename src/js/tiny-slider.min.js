/**
  * tiny-slider
  * @version 0.3.1
  * @author William Lin
  * @license The MIT License (MIT)
  * @github https://github.com/ganlanyuan/tiny-slider/
  * 
  * DEPENDENCIES:
  * firstElementChild, lastElementChild
  * addEventListener
  * extend
  * wrap
  * append
  * 
  */
!function(t){window.tinySlider=t()}(function(){"use strict";function t(t){return t*(180/Math.PI)}function e(t,e){return Math.abs(90-Math.abs(t))>=90-e?"horizontal":Math.abs(90-Math.abs(t))<=e?"vertical":!1}function n(t){return t&&"object"==typeof t?Object.keys(t):!1}function i(t,e){if(t&&"object"==typeof t){for(var n=[],i=0;i<e.length;i++){var a=e[i];n.push(t[a])}return n}return!1}function a(t){var e=document.querySelectorAll(t.container);if(0!==e.length)for(var n=e.length;n--;){var i=t;i.container=e[n];var a=new s(i)}}function s(a){a=gn.extend({container:".slider",items:1,fixedWidth:!1,maxContainerWidth:!1,slideByPage:!1,nav:!0,navText:["prev","next"],navContainer:!1,dots:!0,dotContainer:!1,arrowKeys:!1,speed:250,autoplay:!1,autoplayTimeout:5e3,autoplayDirection:"forward",loop:!0,responsive:!1,lazyload:!1,touch:!0},a||{});var s=this,l=a.container,d=l.children,c=d.length,h=d.length,u=a.fixedWidth,v=a.nav,f=a.navText,y=a.navContainer,m=a.dots,p=a.dotContainer,g=a.arrowKeys,L=o?a.speed:0,M=a.autoplay,x=a.autoplayTimeout,C="forward"===a.autoplayDirection?1:-1,b=u&&!a.maxContainerWidth?!1:a.loop,D=a.slideByPage,k=u?!1:a.responsive,T=a.lazyload,I=a.touch,E,w,N,P,S,A,z=p?c:Math.ceil(c/A),W,q=0,B=!1,X;if(I)var j=0,O=0,F=0,K=0,Y=0,V=0,G=!1,H=!1,B=!1,J=!1;var Q=n(k),R=i(k,Q);this.getItems=function(){return u?function(){return Math.min(c,Math.floor(l.parentNode.offsetWidth/u))}:function(){var t,e=document.documentElement.clientWidth;if(void 0!==Q.length&&void 0!==R&&Q.length===R.length)if(e<Q[0])t=a.items;else if(e>=Q[Q.length-1])t=R[R.length-1];else for(var n=0;n<Q.length-1;n++)e>=Q[n]&&e<=Q[n+1]&&(t=R[n]);else t=a.items;return Math.min(c,t)}}(),this.getItemsMax=function(){var t;return t=u?a.maxContainerWidth?Math.ceil(a.maxContainerWidth/u):!1:void 0!==R.length?Math.max.apply(Math,R):a.items,t?Math.min(c,t):t},A=this.getItems(),S=this.getItemsMax(),this.init=function(){l.classList.add("tiny-content");var t=document.createElement("div");if(t.className="tiny-slider",gn.wrap(l,t),navigator.msMaxTouchPoints&&(t.classList.add("ms-touch"),t.addEventListener("scroll",function(){o&&(l.style[o]="0s"),l.style.transform="translate3d(-"+-l.scrollLeft()+"px,0,0)"})),m)if(p)E=p.children,E[0].classList.add("tiny-active");else{for(var e="",n=c;n--;)e+='<div class="tiny-dot"></div>';e='<div class="tiny-dots">'+e+"</div>",gn.append(t,e),E=t.querySelectorAll(".tiny-dot")}if(v&&(y?(w=y.firstElementChild,N=y.lastElementChild):(gn.append(t,'<div class="tiny-nav"><div class="tiny-prev">'+f[0]+'</div><div class="tiny-next">'+f[1]+"</div></div>"),w=t.querySelector(".tiny-prev"),N=t.querySelector(".tiny-next"))),b){for(var i=document.createDocumentFragment(),a=document.createDocumentFragment(),r=S;r--;){var u=d[r].cloneNode(!0),L=d[c-1-r].cloneNode(!0);i.insertBefore(u,i.firstChild),a.appendChild(L)}l.appendChild(i),l.insertBefore(a,l.firstChild),h=l.children.length,d=l.children}if(this.setDotCurrent(),this.makeLayout(),this.setSnapInterval(),this.translate(),this.itemActive(),v&&(this.disableNav(),N.addEventListener("click",function(){s.onNavClick(1)}),w.addEventListener("click",function(){s.onNavClick(-1)})),m){p||(this.displayDots(),this.dotActive());for(var D=0;D<E.length;D++)E[D].addEventListener("click",this.fireDotClick())}T&&this.lazyLoad(),g&&document.addEventListener("keydown",function(t){t=t||window.event,37===t.keyCode?s.onNavClick(-1):39===t.keyCode&&s.onNavClick(1)}),M&&setInterval(function(){s.onNavClick(C)},x),I&&!J&&l.addEventListener&&(l.addEventListener("touchstart",s.onPanStart(),!1),l.addEventListener("touchmove",s.onPanMove(),!1),l.addEventListener("touchend",s.onPanEnd(),!1),l.addEventListener("touchcancel",s.onPanEnd(),!1),J=!0)},this.getAbsIndex=function(){return 0>q?q+c:q>=c?q-c:q},this.setTransitionDuration=function(t){o&&(l.style[o]=L*t/1e3+"s",B=!0)},this.setDotCurrent=function(){if(W=p?this.getAbsIndex():Math.floor(this.getAbsIndex()/A),!b&&!p){var t=/^-?[0-9]+$/,e=t.test(c/A);e||q!==c-A||(W+=1)}},this.makeLayout=function(){P=u?u:l.parentNode.offsetWidth/A,l.style.width=P*h+"px";for(var t=0;h>t;t++)d[t].style.width=P+"px";if(b){var e=-(S*P);l.style.marginLeft=e+"px"}},this.setSnapInterval=function(){navigator.msMaxTouchPoints&&(l.parentNode.style.msScrollSnapPointsX="snapInterval(0%, "+P+")")},this.itemActive=function(){X=b?q+S:q;for(var t=h;t--;)X>t||t>=X+A?d[t].classList.contains("tiny-visible")&&d[t].classList.remove("tiny-current","tiny-visible"):t===X?d[t].classList.add("tiny-current","tiny-visible"):d[t].classList.contains("tiny-visible")||(d[t].classList.remove("tiny-current"),d[t].classList.add("tiny-visible"))},this.disableNav=function(){b||(0===q?w.classList.add("disabled"):w.classList.remove("disabled"),q===c-A?N.classList.add("disabled"):N.classList.remove("disabled"))},this.displayDots=function(){for(var t=0;t<E.length;t++)z>t?E[t].classList.remove("tiny-hide"):E[t].classList.add("tiny-hide")},this.dotActive=function(){if(m)for(var t=0;z>t;t++)t===W?E[t].classList.add("tiny-active"):E[t].classList.remove("tiny-active")},this.translate=function(){var t=l.parentNode.offsetWidth;F=-P*q,u&&!b&&(F=Math.max(F,-(h*P-t))),r?l.style[r]="translate3d("+F+"px, 0, 0)":l.style.left=F+"px"},this.fallback=function(){if(b){var t=D?-(S-A)>q:-S>=q,e=D?q>c+S-2*A-1:q>=c+S-A;u&&S&&!D&&(e=q>=c+S-A-1),t&&(q+=c),e&&(q-=c),o&&(l.style[o]="0s"),this.translate()}},this.update=function(){this.fallback(),this.itemActive(),this.disableNav(),this.dotActive(),this.lazyLoad(),B=!1},this.onNavClick=function(t){if(!B){var e,n;t=D?t*A:t,n=Math.abs(t),e=q+t,q=b?e:Math.max(0,Math.min(e,c-A)),this.setTransitionDuration(n),this.translate(),this.setDotCurrent(),setTimeout(function(){s.update()},L*n)}},this.fireDotClick=function(){return function(){for(var t,e=0;e<E.length;e++)E[e]===this&&(t=e);s.onDotClick(t)}},this.onDotClick=function(t){if(!B){var e,n;e=p?t:t*A,e=b?e:Math.min(e,c-A),n=Math.abs(e-q),q=e,this.setTransitionDuration(n),this.translate(),W=t,setTimeout(function(){s.update()},L*n)}},this.lazyLoad=function(){if(gn.isInViewport(l)){var t=l.querySelectorAll(".tiny-visible .tiny-lazy");if(0!==!t.length)for(var e=0,n=t.length;n>e;e++)t[e].classList.contains("loaded")||(t[e].src=t[e].getAttribute("data-src"),t[e].classList.add("loaded"))}},this.onPanStart=function(){return function(t){var e=t.changedTouches[0];j=parseInt(e.clientX),O=parseInt(e.clientY)}},this.onPanMove=function(){return function(n){var i=n.changedTouches[0];if(K=parseInt(i.clientX)-j,Y=parseInt(i.clientY)-O,V=t(Math.atan2(Y,K)),G=e(V,15),"horizontal"===G&&B===!1&&(H=!0),H){o&&(l.style[o]="0s");var a=b?-(c+S-A)*P:-(c-A)*P,s=b?S*P:0;!b&&u&&(a=-(c*P-l.parentNode.offsetWidth)),F=-q*P+K,F=Math.max(a,Math.min(F,s)),r?l.style[r]="translate3d("+F+"px, 0, 0)":l.style.left=F+"px",n.preventDefault()}}},this.onPanEnd=function(){return function(t){var e=t.changedTouches[0];if(K=parseInt(e.clientX)-j,H&&0!==K){t.preventDefault(),H=!1,F=-q*P+K;var n,i=b?-S:0,a=b?c+S-A:c-A;n=-(F/P),n=0>K?Math.ceil(n):Math.floor(n),n=Math.max(i,Math.min(n,a)),q=n,s.setTransitionDuration(1),s.translate(),s.setDotCurrent(),setTimeout(function(){s.update()},L)}}},this.init();var U;window.addEventListener("resize",function(){clearTimeout(U),U=setTimeout(function(){A=s.getItems(),z=p?c:Math.ceil(c/A),L=D?a.speed*A:a.speed,s.setDotCurrent(),s.makeLayout(),s.setSnapInterval(),s.translate(),m&&!p&&(s.displayDots(),s.dotActive()),T&&s.lazyLoad()},100)}),window.addEventListener("scroll",function(){T&&s.lazyLoad()})}var o=gn.getSupportedProp(["transitionDuration","WebkitTransitionDuration","MozTransitionDuration","OTransitionDuration"]),r=gn.getSupportedProp(["transform","WebkitTransform","MozTransform","OTransform"]);return a});