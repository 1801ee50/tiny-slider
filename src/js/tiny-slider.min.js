/**
  * tiny-slider
  * @version 0.3.1
  * @author William Lin
  * @license The MIT License (MIT)
  * @github https://github.com/ganlanyuan/tiny-slider/
  * 
  * DEPENDENCIES:
  * firstElementChild, lastElementChild
  * addEventListener
  * extend
  * wrap
  * append
  * indexOf
  * 
  */
!function(t){window.tinySlider=t()}(function(){"use strict";function t(t){return t*(180/Math.PI)}function n(t,n){return Math.abs(90-Math.abs(t))>=90-n?"horizontal":Math.abs(90-Math.abs(t))<=n?"vertical":!1}function e(t){return t&&"object"==typeof t?Object.keys(t):!1}function i(t,n){if(t&&"object"==typeof t){for(var e=[],i=0;i<n.length;i++){var a=n[i];e.push(t[a])}return e}return!1}function a(t){var n=document.querySelectorAll(t.container);if(0!==n.length)for(var e=n.length;e--;){var i=t;i.container=n[e];var a=new s(i)}}function s(a){a=gn.extend({container:".slider",items:1,fixedWidth:!1,maxContainerWidth:!1,slideByPage:!1,nav:!0,navText:["prev","next"],navContainer:!1,dots:!0,dotsContainer:!1,arrowKeys:!1,speed:250,autoplay:!1,autoplayTimeout:5e3,autoplayDirection:"forward",loop:!0,responsive:!1,lazyload:!1,touch:!0},a||{});var s=this,l=a.container,c=l.children,d=c.length,u=c.length,h=a.fixedWidth,v=a.nav,f=a.navText,y=a.navContainer?document.querySelector(a.navContainer):!1,p=a.dots,m=a.dotsContainer?document.querySelector(a.dotsContainer):!1,g=a.arrowKeys,L=o?a.speed:0,M=a.autoplay,C=a.autoplayTimeout,x="forward"===a.autoplayDirection?1:-1,b=h&&!a.maxContainerWidth?!1:a.loop,D=a.slideByPage,T=a.lazyload,k=a.touch,S,E,w,I,N,W,P,z,A=0,q=!1,B=-1;if(k)var O=0,X=0,j=0,F=0,K=0,Y=0,V=!1,G=!1,H=!1;var J=h?!1:a.responsive,Q=e(J),R=i(J,Q);this.getItems=function(){return h?function(){return Math.min(d,Math.floor(l.parentNode.offsetWidth/h))}:function(){var t,n=document.documentElement.clientWidth;if(void 0!==Q.length&&void 0!==R&&Q.length===R.length)if(n<Q[0])t=a.items;else if(n>=Q[Q.length-1])t=R[R.length-1];else for(var e=0;e<Q.length-1;e++)n>=Q[e]&&n<=Q[e+1]&&(t=R[e]);else t=a.items;return Math.min(d,t)}}(),this.getItemsMax=function(){var t;return t=h?a.maxContainerWidth?Math.ceil(a.maxContainerWidth/h):!1:void 0!==R.length?Math.max.apply(Math,R):a.items,t?Math.min(d,t):t},this.getSlideWidth=function(){return h?function(){return h}:function(){return l.parentNode.offsetWidth/w}}(),this.getDotsCount=function(){return m?function(){return d}:function(){return Math.ceil(d/w)}}(),w=this.getItems(),E=this.getItemsMax(),S=this.getSlideWidth(),z=this.getDotsCount(),this.updateLayout=function(){l.style.width=S*u+"px",b&&(l.style.marginLeft=-(E*S)+"px");for(var t=u;t--;)c[t].style.width=S+"px"},this.setTransitionDuration=function(t){o&&(l.style[o]=L*t/1e3+"s",q=!0)},this.setSnapInterval=function(){navigator.msMaxTouchPoints&&(l.parentNode.style.msScrollSnapPointsX="snapInterval(0%, "+S+")")},this.slideActive=function(){for(var t=b?A+E:A,n=u;n--;)t>n||n>=t+w?c[n].classList.contains("tiny-visible")&&c[n].classList.remove("tiny-current","tiny-visible"):n===t?c[n].classList.add("tiny-current","tiny-visible"):c[n].classList.contains("tiny-visible")||(c[n].classList.remove("tiny-current"),c[n].classList.add("tiny-visible"))},this.disableNav=function(){b||(0===A?I.classList.add("disabled"):I.classList.remove("disabled"),A===d-w?N.classList.add("disabled"):N.classList.remove("disabled"))},this.displayDots=function(){if(p&&!m)for(var t=P;t--;){var n=W[t];z>t?n.classList.contains("tiny-hide")&&n.classList.remove("tiny-hide"):n.classList.contains("tiny-hide")||n.classList.add("tiny-hide")}},this.dotActive=function(){if(p){var t;if(-1===B){var n=0>A?A+d:A>=d?A-d:A;if(t=m?n:Math.floor(n/w),!b&&!m){var e=/^-?[0-9]+$/,i=e.test(d/w);i||A!==d-w||(t+=1)}}else t=B;for(var a=z;a--;){var s=W[a];a===t?s.classList.contains("tiny-active")||s.classList.add("tiny-active"):s.classList.contains("tiny-active")&&s.classList.remove("tiny-active")}}},this.translate=function(){var t=l.parentNode.offsetWidth;j=-S*A,h&&!b&&(j=Math.max(j,-(u*S-t))),r?l.style[r]="translate3d("+j+"px, 0, 0)":l.style.left=j+"px"},this.fallback=function(){if(b){var t=D?w-E>A:-E>=A,n=D?A>d+E-2*w-1:A>=d+E-w;h&&E&&!D&&(n=A>=d+E-w-1),t&&(A+=d),n&&(A-=d),o&&(l.style[o]="0s"),this.translate()}},this.update=function(){this.fallback(),this.slideActive(),this.disableNav(),this.dotActive(),this.lazyLoad(),q=!1},this.onNavClick=function(t){if(!q){B=-1;var n,e;t=D?t*w:t,e=Math.abs(t),n=A+t,A=b?n:Math.max(0,Math.min(n,d-w)),this.setTransitionDuration(e),this.translate(),setTimeout(function(){s.update()},L*e)}},this.fireDotClick=function(){return function(){var t=gn.indexOf(W,this);s.onDotClick(t)}},this.onDotClick=function(t){if(!q){B=t;var n,e;n=m?t:t*w,n=b?n:Math.min(n,d-w),e=Math.abs(n-A),A=n,this.setTransitionDuration(e),this.translate(),setTimeout(function(){s.update()},L*e)}},this.lazyLoad=function(){if(gn.isInViewport(l)){var t=l.querySelectorAll(".tiny-visible .tiny-lazy");if(0!==t.length)for(var n=0,e=t.length;e>n;n++)t[n].classList.contains("loaded")||(t[n].src=t[n].getAttribute("data-src"),t[n].classList.add("loaded"))}},this.onPanStart=function(){return function(t){var n=t.changedTouches[0];O=parseInt(n.clientX),X=parseInt(n.clientY)}},this.onPanMove=function(){return function(e){var i=e.changedTouches[0];if(F=parseInt(i.clientX)-O,K=parseInt(i.clientY)-X,Y=t(Math.atan2(K,F)),V=n(Y,15),"horizontal"===V&&q===!1&&(G=!0),G){o&&(l.style[o]="0s");var a=b?-(d+E-w)*S:-(d-w)*S,s=b?E*S:0;!b&&h&&(a=-(d*S-l.parentNode.offsetWidth)),j=-A*S+F,j=Math.max(a,Math.min(j,s)),r?l.style[r]="translate3d("+j+"px, 0, 0)":l.style.left=j+"px",e.preventDefault()}}},this.onPanEnd=function(){return function(t){var n=t.changedTouches[0];if(F=parseInt(n.clientX)-O,G&&0!==F){t.preventDefault(),G=!1,j=-A*S+F;var e,i=b?-E:0,a=b?d+E-w:d-w;e=-(j/S),e=0>F?Math.ceil(e):Math.floor(e),e=Math.max(i,Math.min(e,a)),A=e,s.setTransitionDuration(1),s.translate(),setTimeout(function(){s.update()},L)}}},this.init=function(){l.classList.add("tiny-content");var t=document.createElement("div");if(t.className="tiny-slider",gn.wrap(l,t),navigator.msMaxTouchPoints&&(t.classList.add("ms-touch"),t.addEventListener("scroll",function(){o&&(l.style[o]="0s"),l.style.transform="translate3d(-"+-l.scrollLeft()+"px,0,0)"})),p){if(m)W=m.children,W[0].classList.add("tiny-active");else{for(var n="",e=d;e--;)n+='<div class="tiny-dot"></div>';n='<div class="tiny-dots">'+n+"</div>",gn.append(t,n),W=t.querySelectorAll(".tiny-dot")}P=W.length}if(v&&(y?(I=y.firstElementChild,N=y.lastElementChild):(gn.append(t,'<div class="tiny-nav"><div class="tiny-prev">'+f[0]+'</div><div class="tiny-next">'+f[1]+"</div></div>"),I=t.querySelector(".tiny-prev"),N=t.querySelector(".tiny-next"))),b){for(var i=document.createDocumentFragment(),a=document.createDocumentFragment(),r=E;r--;){var h=c[r].cloneNode(!0),L=c[d-1-r].cloneNode(!0);i.insertBefore(h,i.firstChild),a.appendChild(L)}l.appendChild(i),l.insertBefore(a,l.firstChild),u=l.children.length,c=l.children}if(this.updateLayout(),this.setSnapInterval(),this.translate(),this.slideActive(),v&&(this.disableNav(),N.addEventListener("click",function(){s.onNavClick(1)}),I.addEventListener("click",function(){s.onNavClick(-1)})),this.displayDots(),this.dotActive(),p)for(var D=0;P>D;D++)W[D].addEventListener("click",this.fireDotClick());T&&this.lazyLoad(),g&&document.addEventListener("keydown",function(t){t=t||window.event,37===t.keyCode?s.onNavClick(-1):39===t.keyCode&&s.onNavClick(1)}),M&&setInterval(function(){s.onNavClick(x)},C),k&&!H&&l.addEventListener&&(l.addEventListener("touchstart",s.onPanStart(),!1),l.addEventListener("touchmove",s.onPanMove(),!1),l.addEventListener("touchend",s.onPanEnd(),!1),l.addEventListener("touchcancel",s.onPanEnd(),!1),H=!0)},this.init();var U;window.addEventListener("resize",function(){clearTimeout(U),U=setTimeout(function(){w=s.getItems(),S=s.getSlideWidth(),z=s.getDotsCount(),s.updateLayout(),s.setSnapInterval(),s.translate(),s.displayDots(),s.dotActive(),T&&s.lazyLoad()},100)}),window.addEventListener("scroll",function(){T&&s.lazyLoad()})}var o=gn.getSupportedProp(["transitionDuration","WebkitTransitionDuration","MozTransitionDuration","OTransitionDuration"]),r=gn.getSupportedProp(["transform","WebkitTransform","MozTransform","OTransform"]);return a});